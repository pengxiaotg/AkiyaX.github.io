---
title: 'C#è®¾è®¡æ¨¡å¼[4] - å»ºé€ è€…æ¨¡å¼'
category: è®¾è®¡æ¨¡å¼
tags: .net
date: 2020-03-27 17:23:45
id: builder-pattern
---

ğŸš€[24ä¸ªC#è®¾è®¡æ¨¡å¼ç›®å½•](https://akiyax.github.io/csharp-design-pattern/) &nbsp;&nbsp; ğŸº[æºç åœ°å€](https://github.com/AkiyaX/CSharpDesignPattern)

# æ¦‚è¿°

å¯¹äºä»Šå¤©å¤§éƒ¨åˆ†çš„çš„æ‰‹æœºğŸ“±å‚å•†è€Œè¨€ï¼ŒğŸ“±çš„åˆ¶é€ éœ€è¦å„ä¸ªä¾›åº”å•†æä¾›é›¶éƒ¨ä»¶ï¼Œç„¶åå†æŒ‰ç…§è‡ªå·±çš„è®¾è®¡ç»„è£…å®Œæˆã€‚

ä»¥ ä¸€åŠ 7T è¿™å°æœºå‹ä¸¾ä¾‹ï¼š

|éƒ¨ä»¶|ä¾›åº”å•†|äº§å“|
|---|---|---|
|SOC|é«˜é€š|éªé¾™ 855 Plus|
|å±å¹•|ä¸‰æ˜Ÿ|6.55è‹±å¯¸çš„90 Hzæµä½“å±å¹•|
|ä¸»æ‘„é•œå¤´|ç´¢å°¼|4800ä¸‡åƒç´ çš„IMX 586|
|ç”µæ± |æ¬£æ—ºè¾¾ç”µå­|3800 mAhé”‚ç”µæ± |

å¯¹äºä¸€åŠ æ¥è¯´ï¼Œå¹¶ä¸éœ€è¦çŸ¥é“è¿™äº›é›¶éƒ¨ä»¶çš„ç”Ÿäº§è¿‡ç¨‹ï¼Œè€Œæ˜¯å…³æ³¨å¦‚ä½•å°†é›¶éƒ¨ä»¶æ„å»ºæˆğŸ“±çš„è¿‡ç¨‹ï¼Œæœ€ç»ˆç”Ÿäº§å‡ºä¸€éƒ¨å®Œæ•´çš„ğŸ“±äº§å“ã€‚å¯¹äºç”¨æˆ·æ¥è¯´ï¼Œä¸éœ€è¦å…³æ³¨ğŸ“±å¦‚ä½•ä¸€æ­¥æ­¥ç”Ÿäº§å‡ºæ¥ï¼Œåªéœ€è¦æŒ‡å®šæœºå‹ï¼Œå°±å¯ä»¥è´­ä¹°æ‰‹æœºäº§å“ã€‚

>**å»ºé€ è€…æ¨¡å¼**ï¼šå°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚

å»ºé€ è€…æ¨¡å¼å°†å®¢æˆ·ç«¯ä¸åŒ…å«å¤šä¸ªéƒ¨ä»¶çš„å¤æ‚å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹åˆ†ç¦»ï¼Œå³ä½¿åœ¨ç›¸åŒçš„æµæ°´çº¿ï¼Œæ›´æ¢é›¶éƒ¨ä»¶å°±å¯ä»¥ç”Ÿäº§å‡ºä¸åŒçš„äº§å“ã€‚å®¢æˆ·ç«¯æ— é¡»çŸ¥é“å¤æ‚å¯¹è±¡çš„å†…éƒ¨ç»„æˆéƒ¨åˆ†ä¸è£…é…æ–¹å¼ï¼Œåªéœ€çŸ¥é“æ‰€å»ºé€ è€…çš„ç±»å‹å³å¯ã€‚

ä½¿ç”¨é¢‘ç‡ï¼šâ˜…â˜…â˜…â˜†â˜†

# ç»“æ„ä¸å®ç°

åœ¨å»ºé€ è€…æ¨¡å¼ä¸­ï¼ŒåŒ…å«4ä¸ªè§’è‰²ï¼š

- Builderï¼ˆæŠ½è±¡å»ºé€ è€…ï¼‰
- ConcreteBuilderï¼ˆå…·ä½“å»ºé€ è€…ï¼‰
- Productï¼ˆäº§å“ï¼‰
- Directorï¼ˆæŒ‡æŒ¥è€…ï¼‰

åœ¨æŠ½è±¡å»ºé€ è€…`Builder`ä¸­ï¼Œæœ‰ä¸¤ç±»æ–¹æ³•ï¼Œä¸€ç±»æ˜¯`BuildPartX()`ç”¨äºæ„å»ºå„ä¸ªéƒ¨ä»¶ï¼Œå¦ä¸€ç±»æ–¹æ³•æ˜¯`GetResult()`ç”¨äºè·å–åˆ›å»ºå¥½çš„å¤æ‚å¯¹è±¡ã€‚`Builder`æ—¢å¯ä»¥åšæ¥å£ï¼Œä¹Ÿå¯åšæŠ½è±¡ç±»ï¼Œå®ç°éƒ¨åˆ†æ–¹æ³•ï¼Œæ¯”å¦‚`GetResult()`ã€‚

æŒ‡æŒ¥è€…`Director`è´Ÿè´£å®‰æ’å¤æ‚å¯¹è±¡çš„å»ºé€ æ¬¡åºï¼Œå®¢æˆ·ç«¯ä¸€èˆ¬åªéœ€è¦ä¸æŒ‡æŒ¥è€…äº¤äº’ã€‚

{% plantuml %}

    !includeurl https://raw.githubusercontent.com/AkiyaX/AkiyaX.github.io/hexo/theme.puml  

    package ConcreteBuilder <<Folder>> {
        class OnePlus6TBuilder
        class OnePlus7TBuilder
    }

    class Phone {
        + string Name
        + string SOC
        + string Screen
        + string Battery
        + string Camera
    }
    note right: Product

    abstract class PhoneBuilder {
        # Phone phone
        + void BuildName();
        + void BuildSOC();
        + void BuildScreen();
        + void BuildCamera();
        + void BuildBattery();
        + Phone GetPhone()
    }
    note right: Builder

    class OnePlus6TBuilder {
        + void BuildName();
        + void BuildSOC();
        + void BuildScreen();
        + void BuildCamera();
        + void BuildBattery();
    }

    class OnePlus7TBuilder {
        + void BuildName();
        + void BuildSOC();
        + void BuildScreen();
        + void BuildCamera();
        + void BuildBattery();
    }

    class OnePlus {
        - PhoneBuilder builder
        + Phone Construct()
    }
    note left: Director

    Phone <|.. PhoneBuilder
    PhoneBuilder <|-- OnePlus6TBuilder
    PhoneBuilder <|-- OnePlus7TBuilder
    OnePlus o-> PhoneBuilder : builder

{% endplantuml %}


ä»¥ä¸€åŠ æ‰‹æœºä¸¾ä¾‹ï¼Œä¸€åŠ ä½œä¸ºæŒ‡æŒ¥è€…ï¼Œå…·ä½“å»ºé€ è€…åŒ…æ‹¬ä¸€åŠ 6Tå’Œä¸€åŠ 7Tä¸¤æ¬¾æ‰‹æœºçš„å»ºé€ è€…ï¼Œå®ç°äº†PhoneBuilderï¼Œä½¿ç”¨äº†**ä¸åŒ**çš„`BuildSOC`ã€`BuildScreen`ç­‰æ–¹æ³•é€‰ç”¨ä¸åŒçš„é›¶éƒ¨ä»¶ï¼Œä½†æ˜¯OnePlusä½¿ç”¨**ç›¸åŒ**çš„`Construct`è£…é…æµç¨‹ï¼Œå¯ä»¥ç”Ÿäº§å‡ºä¸¤ç§ä¸åŒå‹å·çš„ğŸ“±ã€‚

```cs
// Product
class Phone
{
    // Part1
    public string Name { get; set; }
    // Part2
    public string SOC { get; set; }
    // Part3
    public string Screen { get; set; }
    // Part4
    public string Battery { get; set; }
    // Part5
    public string Camera { get; set; }
}
```

```cs
//Builder
abstract class PhoneBuilder
{
    // åˆ›å»ºäº§å“å¯¹è±¡
    protected Phone phone = new Phone();
    public abstract void BuildName();
    public abstract void BuildSOC();
    public abstract void BuildScreen();
    public abstract void BuildCamera();
    public abstract void BuildBattery();

    // è·å–äº§å“å¯¹è±¡ GetResult
    public Phone GetPhone()
    {
        return phone;
    }
}
```

```cs
// ConcreteBuilder
class OnePlus6TBuilder : PhoneBuilder
{
    public override void BuildName()
    {
        this.phone.Name = "OnePlus 6T";
    }
    public override void BuildSOC()
    {
        this.phone.SOC = "Qualcomm Snapdragon 845";
    }
    public override void BuildScreen()
    {
        this.phone.Screen = "6.41-inch 19.5:9 Optic AMOLED";
    }
    public override void BuildCamera()
    {
        this.phone.Camera = "Sony IMX 519";
    }
    public override void BuildBattery()
    {
        this.phone.Battery = "3700 mAh lithium battery";
    }
}
```

```cs
// ConcreteBuilder
class OnePlus7TBuilder : PhoneBuilder
{
    public override void BuildName()
    {
        this.phone.Name = "OnePlus 7T";
    }
    public override void BuildSOC()
    {
        this.phone.SOC = "Qualcomm Snapdragon 855 Plus";
    }
    public override void BuildScreen()
    {
        this.phone.Screen = "Samsung 6.55-inch 90Hz Fluid Display";
    }
    public override void BuildCamera()
    {
        this.phone.Camera = "Sony IMX 586";
    }
    public override void BuildBattery()
    {
        this.phone.Battery = "3800 mAh lithium battery";
    }
}
```

Directorä¸­çš„`Construct()`æ–¹æ³•å®šä¹‰äº†`BuildPartX()`çš„è°ƒç”¨æ¬¡åºï¼Œæä¾›äº†ä¸€ä¸ªæµç¨‹æ¨¡æ¿ã€‚

```cs
// Director
class OnePlus
{
    private PhoneBuilder phoneBuilder;

    public void SetPhoneBuilder(PhoneBuilder phoneBuilder)
    {
        this.phoneBuilder = phoneBuilder;
    }
    public Phone Construct()
    {
        phoneBuilder.BuildName();
        phoneBuilder.BuildSOC();
        phoneBuilder.BuildScreen();
        phoneBuilder.BuildCamera();
        phoneBuilder.BuildBattery();
        return phoneBuilder.GetPhone();
    }
}
```

å®¢æˆ·ç«¯è°ƒç”¨æ—¶ï¼Œéœ€è¦ä¸ºä¸€åŠ æŒ‡å®šæœºå‹ï¼ˆå…·ä½“å»ºé€ è€…ï¼‰ï¼Œå°±å¯ä»¥è·å¾—å…·ä½“çš„ğŸ“±äº§å“ã€‚æŒ‡å®šå…·ä½“å»ºé€ è€…å®ä¾‹ä¹Ÿå¯ä»¥ä½¿ç”¨é…ç½®æ–‡ä»¶ç­‰æ–¹æ³•æ³¨å…¥ã€‚

```cs
static void Main(string[] args)
{
    OnePlus onePlus = new OnePlus();
    onePlus.SetPhoneBuilder(new OnePlus7TBuilder());
    //onePlus.SetPhoneBuilder(new OnePlus6TBuilder());
    Phone phone = onePlus.Construct();
    Console.WriteLine(phone.Name);
    Console.WriteLine(phone.SOC);
    Console.WriteLine(phone.Screen);
    Console.WriteLine(phone.Camera);
    Console.WriteLine(phone.Battery);
}
```

åœ¨å»ºé€ è€…æ¨¡å¼ä¸­ï¼ŒDirectorè§’è‰²å¯ä»¥ä¸Builderè§’è‰²åˆå¹¶ï¼Œä¹Ÿå°±æ˜¯å°†Directorçš„`Construct()`æ–¹æ³•ç›´æ¥å†™å…¥Builderçš„`GetResult()`æ–¹æ³•ä¸­ã€‚è¿™ç§å®ç°ä¼šç®€åŒ–äº†ç³»ç»Ÿï¼Œä¸”ä¸å½±å“çµæ´»æ€§å’Œæ‰©å±•æ€§ï¼Œä½†æ˜¯åŠ é‡äº†Builderçš„èŒè´£ï¼Œå¯¹äº`Construct()`æ–¹æ³•è¾ƒä¸ºå¤æ‚çš„åœºæ™¯ä¸é€‚ç”¨ã€‚


# ä¼˜ç¼ºç‚¹

ä¼˜ç‚¹ï¼š

1. å®¢æˆ·ç«¯ä¸å¿…çŸ¥é“äº§å“å†…éƒ¨ç»„æˆçš„ç»†èŠ‚ï¼Œå°†äº§å“æœ¬èº«ä¸äº§å“çš„åˆ›å»ºè¿‡ç¨‹è§£è€¦ï¼Œä½¿å¾—ç›¸åŒçš„åˆ›å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„äº§å“å¯¹è±¡ã€‚
2. å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å¢åŠ æˆ–æ›´æ¢å…·ä½“å»ºé€ è€…ã€‚
3. å°†å¤æ‚çš„äº§å“åˆ›å»ºæ­¥éª¤åˆ†è§£åœ¨ä¸åŒçš„æ–¹æ³•ä¸­ï¼Œä½¿å¾—åˆ›å»ºè¿‡ç¨‹æ›´åŠ æ¸…æ™°ï¼Œæ§åˆ¶ä¹Ÿæ›´ä¸ºæ–¹ä¾¿ã€‚

ç¼ºç‚¹ï¼š

1. å»ºé€ è€…æ¨¡å¼è¦æ±‚æ‰€åˆ›å»ºçš„äº§å“æœ‰è¾ƒå¤šçš„å…±åŒç‚¹ï¼Œç»„æˆæˆåˆ†ç›¸ä¼¼ï¼Œå¦‚æœäº§å“é—´å·®å¼‚è¾ƒå¤§åˆ™ä¸é€‚åˆå»ºé€ è€…æ¨¡å¼ã€‚
2. å¦‚æœäº§å“å†…éƒ¨ç»„æˆå˜åŒ–å¤æ‚ï¼Œå¯èƒ½ä¼šéœ€è¦å®šä¹‰å¾ˆå¤šå…·ä½“å»ºé€ è€…ç±»æ¥å®ç°è¿™ç§å˜åŒ–ï¼Œå¯¼è‡´ç³»ç»Ÿå˜çš„å¾ˆåºå¤§ï¼Œå¢åŠ ç³»ç»Ÿç†è§£éš¾åº¦å’Œè¿è¡Œæˆæœ¬ã€‚

# é€‚ç”¨åœºæ™¯

- éœ€è¦ç”Ÿäº§çš„äº§å“æœ‰å¤æ‚çš„å†…éƒ¨ç»“æ„ï¼Œè¿™äº›äº§å“å¯¹è±¡é€šå¸¸åŒ…å«å¤šä¸ªæˆå‘˜å˜é‡ã€‚
- éœ€è¦ç”Ÿäº§çš„äº§å“å¯¹è±¡ç†Ÿæ‚‰ç›¸äº’ä¾èµ–ï¼Œéœ€è¦æŒ‡å®šå…¶ç”Ÿäº§é¡ºåºã€‚
- å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ç‹¬ç«‹äºåˆ›å»ºè¯¥å¯¹è±¡çš„ç±»ã€‚
- éš”ç¦»å¤æ‚å¯¹è±¡çš„åˆ›å»ºå’Œä½¿ç”¨ï¼Œå¹¶ä½¿å¾—ç›¸åŒçš„åˆ›å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„äº§å“ã€‚